function csrfSafeMethod(a){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(a)}var MailList=function(){function a(){j=$("#mailList"),l=$("#footer"),j.on("mouseenter",e).on("mouseleave",f),k=$("#txtEmail")}function b(a){switch(o&&(clearTimeout(o),o=setTimeout(g,5e3)),a.which){case 32:case 39:case 34:case 96:return a.preventDefault(),!1;case 13:return c(),!1}m&&(m=!1,$("#emailError").addClass("displayNone"))}function c(){var a=k.val();return""!=a&&i(a)?(g(),k.val(""),$.ajax("/newsletter/signup/",{cache:!1,data:{email:a},success:d,type:"post",error:function(){d({success:"false"})}}),void 0):(h(),void 0)}function d(a){a&&a.success===!0?Main.showAlert("/static/html/emailSuccess.html"):Main.showAlert("/static/html/emailError.html")}function e(){o&&clearTimeout(o),n||(n=!0,l.addClass("show-maillist"),k.on("keydown",b))}function f(){o=setTimeout(g,1700)}function g(){n=!1,o&&clearTimeout(o),m&&(m=!1,$("#emailError").addClass("displayNone")),l.removeClass("show-maillist"),k.off("keydown",b).blur()}function h(){m=!0,$("#emailError").removeClass("displayNone")}function i(a){var b=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)}var j,k,l=!1,m=!1,n=!1,o=null;return{init:a,submitEmail:c,hideMailList:g}}(),Video=function(){function a(a){"undefined"!=typeof a&&"undefined"!=typeof a.path&&(g=a.path)}function b(a,b){var c=videojs(a,{controls:!0,autoplay:!0,preload:"auto",loop:b.loop,width:"100%",height:"auto",poster:"/static/img/video-poster.gif"},function(){this.src(g+b.videoFile)});return c.on("fullscreenchange",e),f.push(c),c}function c(a){for(var b=f.length-1;b>=0;b--)if(a==f[b]){a.pause(),a.off("fullscreenchange"),a.dispose(),f.splice(b,1);break}}function d(a){var b,c=0;if("undefined"!=typeof a)for(c=0,b=f.length;b>c;c++)a==f[c]&&f[c].pause();else for(c=0,b=f.length;b>c;c++)f[c].pause()}function e(){$("body").hasClass("in-fullscreen")?$("body").removeClass("in-fullscreen"):$("body").addClass("in-fullscreen")}var f=[],g="http://video.steveshaddick.com/";return{init:a,create:b,dispose:c,pause:d}}(),Work=function(){function a(){i=$("#workWrapper"),k=$("#noWork"),j=$("#thumbsWrapper"),l=k.parent(),j.on("mouseenter",".work-thumb",b),j.on("mouseleave",".thumb-over-img",d),j.on("mouseleave",c)}function b(){var a=$(this);if(a.data("isOver")!==!0){a.data("isOver",!0),$(".thumb-over-img",j).mouseleave();var b=$('<img class="thumb-over-img transition small" src="'+$("img",a).attr("src")+'" alt="">'),c=$("#cls .thumb-over-info").clone();$(".title",c).html(a.attr("data-title")),$(".type",c).html(a.attr("data-type")),b.data("info",c),a.append(b),a.parent().addClass("hover"),b.data("to1",setTimeout(function(){b.removeClass("small")},0)),a.append(c),b.data("to2",setTimeout(function(){c.removeClass("hold-high")},250))}}function c(a){var b=$(a.target);b.hasClass("thumb-img")?$(".thumb-over-img",b.parent()).mouseleave():b.hasClass("thumbs-wrapper")&&$(".thumb-over-img",j).mouseleave()}function d(){var a=$(this);if(!a.data("leaving")){a.data("leaving",!0);var b=a.data("info").offset(),c=a.data("info");a.data("info").css({top:b.top-$(window).scrollTop(),left:b.left}),$("#dropOverlay").removeClass("displayNone").append(c),a.addClass("small"),setTimeout(function(){c.css("top","").addClass("drop")},10),clearTimeout(a.data("to1")),clearTimeout(a.data("to2")),a.parent().parent().removeClass("hover"),setTimeout(function(){a.parent().data("isOver",!1),a.remove()},350),setTimeout(function(){c.remove(),0===$("#dropOverlay").children().length&&$("#dropOverlay").addClass("displayNone")},500)}}function e(){$.contains(document.documentElement,k[0])||g({type:"nowork"}),setTimeout(function(){$(".me-blurry",k).removeClass("out")},0)}function f(){if(m)switch($("#work_"+m.id).removeClass("selected"),m.type){case"video":Video.pause(n)}var a=l,b=n;TransitionController.transitionEnd(a,function(){Video.dispose(b),a.remove()}),a.addClass("drop")}function g(a){f(),m=a,l=$("#cls .work-content").clone(),a.title&&$("h1",l).html(a.title),a.specs&&""!==a.specs&&$(".work-specs",l).html(a.specs),a.info&&""!==a.info?$(".work-info",l).html(a.info):$(".work-info",l).remove(),$("#work_"+a.id).addClass("selected");var b=!1;switch(a.type){case"video":var c=$("#cls .video-container").clone(),d="video_"+a.id;$("video",c)[0].id=d,l.prepend(c),b=function(){n=Video.create(d,a)};break;case"website":var e=a.url.replace("http://","");"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),$(".work-link",l).attr("href",a.url).html(e);var g=$("#cls .web-container").clone();g.attr("href",a.url),""===$(".work-specs",l).html()&&$(".work-specs",l).html("website"),$(".big-image",g).attr("src",a.image),l.prepend(g);break;case"404":var h=$("#cls .four-oh-four-container").clone();a.text&&$(".text",h).html(a.text),a.randomWork&&$(".redirect-link",h).attr("href","/#/"+a.randomWork),l.prepend(h);break;case"nowork":l.prepend(k)}i.append(l),setTimeout(function(){l.removeClass("hold-high"),b&&TransitionController.transitionEnd(l,b)},10),$(".thumb-over-img",j).mouseleave()}function h(a){$.post("/work/"+a+"/",{},function(a){a?g(a):(a={id:"4O4",type:"404"},g(a))})}var i=!1,j=!1,k=!1,l=!1,m=!1,n=!1;return{init:a,getWork:h,showNoWork:e}}(),Main=function(){function a(a){$.ajaxSetup({crossDomain:!1,beforeSend:function(a,b){csrfSafeMethod(b.type)||a.setRequestHeader("X-CSRFToken",Cookie.get("csrftoken"))}}),Modernizr.csstransitions||TransitionController.setAutoWait(350),h=$("#mainPage"),i=$("#whoPage"),j=$(window),MailList.init(),Work.init(),a.isMobile&&Video.init({path:"http://video.steveshaddick.com/iphone/"}),WindowResize.addHandler(e),$(".nav-link.work").on("click",function(){"who"===f&&("undefined"!=typeof g?window.location="/#/"+g:(window.location="/#",setTimeout(function(){$("body,html").animate({scrollTop:$("#thumbsWrapper").offset().top},350)},350)))}),SWFAddress.onChange=b,a.needUrlCheck&&$.get("/check-urls/")}function b(){var a=SWFAddress.getPathNames();if(g=f,a.length>0)switch($("body,html").animate({scrollTop:0},350),a[0]){case"who":i.animate({scrollTop:0},350),Video.pause(),i.removeClass("page-closed"),$("body").addClass("page-who"),$("#whoBackLink").attr("href","/#/"+g);break;default:h.animate({scrollTop:0},350),i.addClass("page-closed"),$("body").removeClass("page-who"),"who"!==g&&Work.getWork(a[0])}else $("body").removeClass("page-who"),i.addClass("page-closed"),Work.showNoWork();f=a[0]}function c(a,b){d(!0);var c=$("#alertOverlayBox");$("#alertOverlay").removeClass("displayNone"),c.load(a,null,b).addClass("transition").removeClass("reset")}function d(a){var b=$("#alertOverlayBox");b.html("").removeClass("transition").addClass("reset"),a!==!0&&$("#alertOverlay").addClass("displayNone")}function e(){var a=0,b=!1,c=!1,d=0,e=0,f=0;$(".thumb-item-wrapper").removeClass("right-side").each(function(){c=$(this),d=c.offset().top,b&&d!=a&&(b.addClass("right-side"),f=e,e=0),e++,a=d,b=c,e==f&&c.addClass("right-side")});var g=j.height()-47;h.css({height:g}),i.css({height:g})}var f="",g="",h=!1,i=!1,j=!1;return{init:a,showAlert:c,closeAlert:d}}(),TransitionController=function(){function a(a,b,c){"undefined"==typeof c&&(c=e),0>c?(a.off(d),a.on(d,function(c){$(c.target).eq(a)&&(a.off(d),b(a))})):setTimeout(function(){b(a)},c)}function b(a){e=a}var c={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",transition:"transitionend"},d=c[Modernizr.prefixed("transition")],e=-1;return{transitionEnd:a,setAutoWait:b}}();