function SimpleVideo(a,b){if(this.$element=$("#"+a),this.$video=null,this.$flash=null,this.flashId=null,this.solution="",this.firstLoad=!1,this.controller=null,this.hideTimeout=null,this.isOver=!1,this.controlsActive=!1,this.isPlaying=!1,this.videoPoster="",this.audioPoster="",this.isVideo=!0,this.state="nomedia",this.canScrub=!0,this.objConfig={defaultVolume:"undefined"!=typeof b.defaultVolume?b.defaultVolume:.8,nativeControls:"undefined"!=typeof b.nativeControls?b.nativeControls:!1,allowFullscreen:"undefined"!=typeof b.allowFullscreen?b.allowFullscreen:!0,trueFullscreen:"undefined"!=typeof b.trueFullscreen?b.trueFullscreen:!0,onFullscreen:"undefined"!=typeof b.onFullscreen?b.onFullscreen:null,onNormalscreen:"undefined"!=typeof b.onNormalscreen?b.onNormalscreen:null,posterPath:"undefined"!=typeof b.posterPath?b.posterPath:""},this.volume=this.objConfig.defaultVolume,this.solution=document.createElement("video").canPlayType?"html":"flash","html"==this.solution?($(".sv_flashContainer",this.$element).remove(),this.controller=new HTMLController(this)):($(".sv_video",this.$element).remove(),this.controller=new FlashController(this)),this.controller.valid===!1)return this.solution=!1,void 0;if(SimpleVideoEventHandler.addPlayer(a,this.controller),this.videoPoster=$(".sv_videoPoster",this.$element).attr("src"),this.audioPoster=$(".sv_audioOlny",this.$element).attr("src"),this.objConfig.nativeControls)return this.controller.setPoster(this.videoPoster),$(".sv_display",this.$element).remove(),void 0;this.$display=$(".sv_display",this.$element),this.$buffering=$(".sv_buffering",this.$element),this.$audioOnly=$(".sv_audioOnly",this.$element),this.$poster=$(".sv_videoPoster",this.$element),this.$controls=$(".sv_controls",this.$element),this.$restartButton=$(".sv_restart",this.$element),this.$playButton=$(".sv_play",this.$element),this.$pauseButton=$(".sv_pause",this.$element),this.$muteButton=$(".sv_mute",this.$element),this.$unmuteButton=$(".sv_unmute",this.$element),this.$volumeSlider=$(".sv_vslider",this.$element),this.$volumeMarker=$(".sv_vmarker",this.$element),this.$volumeMaxButton=$(".sv_vmax",this.$element),this.$fullscreenButton=$(".sv_fullscreen",this.$element),this.$normalscreenButton=$(".sv_normalscreen",this.$element),this.objConfig.allowFullscreen||(this.$fullscreenButton.addClass("inactive"),this.$normalscreenButton.addClass("inactive")),this.$loadProgress=$(".sv_loaded",this.$element),this.$playProgress=$(".sv_playhead",this.$element),this.$scrubber=$(".sv_scrubber",this.$element),this.bindListeners();var c=this;fullScreenApi.supportsFullScreen&&this.objConfig.trueFullscreen&&$(window).bind("fullscreen-off",function(){c.normalscreen()}),this.setState("volume",{volume:this.volume})}function HTMLController(a){this.sv=a,this.$video=$(".sv_video",a.$element),this.htmlVolume=a.volume,this.loop=!1,this.$video[0].controls=!1,this.valid=!0}function FlashController(a){this.sv=a,this.$flash=$(".sv_flashContainer",a.$element),this.flashId=a.$element[0].id+"_flash",this.flashVolume=a.volume,this.valid=!1,this.flashLoaded=!1,this.$flash[0].id=this.flashId,swfobject.hasFlashPlayerVersion("10")?this.valid=!0:($(".sv_display",this.sv.$element).remove(),this.valid=!1)}Cookie={get:function(a){return tmp=document.cookie.match(new RegExp(a+"=[a-zA-Z0-9.()=|%/]+($|;)","g")),tmp&&tmp[0]?unescape(tmp[0].substring(a.length+1,tmp[0].length).replace(";",""))||null:null},set:function(a,b,c,d,e,f){return cookie=[a+"="+escape(b),"path="+(d&&""!=d?d:"/"),"domain="+(e&&""!=e?e:window.location.hostname)],c&&cookie.push(Cookie.hoursToExpireDate(c)),f&&cookie.push("secure"),document.cookie=cookie.join("; ")},unset:function(a,b,c){b=b&&"string"==typeof b?b:"",c=c&&"string"==typeof c?c:"",Cookie.get(a)&&Cookie.set(a,"","Thu, 01-Jan-70 00:00:01 GMT",b,c)},hoursToExpireDate:function(a){return"NaN"==parseInt(a)?"":(now=new Date,now.setTime(now.getTime()+1e3*60*60*parseInt(a)),now.toGMTString())},test:function(){return Cookie.set("b49f729efde9b2578ea9f00563d06e57","true"),"true"==Cookie.get("b49f729efde9b2578ea9f00563d06e57")?(Cookie.unset("b49f729efde9b2578ea9f00563d06e57"),!0):!1},dump:function(){"undefined"!=typeof console&&console.log(document.cookie.split(";"))}};var SimpleVideoEventHandler=function(){function a(a,b){d[a]=b}function b(a,b,c){d[a].flashEvent(b,c)}function c(a){d[a.data.id].htmlEvent(a)}var d=[];return{addPlayer:a,flashEvent:b,htmlEvent:c}}();SimpleVideo.prototype.bindListeners=function(){var a=this;this.$element.hover(function(){a.showControls()},function(){a.setHide(800)}),this.$element.mousemove(function(){a.controlsActive||(a.controlsActive=!0,a.$controls.removeClass("inactive").addClass("active"),a.setHide(2500))}),this.$display.click(function(){a.isPlaying?a.pause():a.play()}),this.$controls.hover(function(){a.setHide(8e3)},function(){a.setHide(2500)}),this.$restartButton.click(function(){a.restart()}),this.$playButton.click(function(){a.play()}),this.$pauseButton.click(function(){a.pause()}),this.$muteButton.click(function(){a.mute()}),this.$unmuteButton.click(function(){a.unmute()}),this.$volumeMaxButton.click(function(){a.maxVolume()}),this.$volumeSlider.click(function(b){a.vSliderClick(b)}),this.$scrubber.click(function(b){a.scrubberClick(b)}),this.$fullscreenButton.click(function(){a.fullscreen()}),this.$normalscreenButton.click(function(){a.normalscreen()}),this.controller.bindListeners()},SimpleVideo.prototype.breakListeners=function(){this.$element.unbind(),this.$display.unbind(),this.$controls.unbind(),this.$restartButton.unbind(),this.$playButton.unbind(),this.$pauseButton.unbind(),this.$muteButton.unbind(),this.$unmuteButton.unbind(),this.$volumeMaxButton.unbind(),this.$volumeSlider.unbind(),this.$fullscreenButton.unbind(),this.$normalscreenButton.unbind(),this.controller.breakListeners()},SimpleVideo.prototype.init=function(a){this.initializing||(this.initializing=!0,this.controller.init(a))},SimpleVideo.prototype.setState=function(a,b){if(this.solution&&!this.objConfig.nativeControls)switch(this.firstLoad||"volume"==a||(a="nomedia"),a){case"nomedia":this.$buffering.removeClass("active").addClass("inactive"),this.$poster.removeClass("inactive"),this.state=a;break;case"buffering":this.$poster.addClass("inactive"),this.$buffering.removeClass("inactive").addClass("active"),this.state=a;break;case"playing":this.isPlaying=!0,this.$buffering.removeClass("active").addClass("inactive"),this.$pauseButton.removeClass("inactive").addClass("active"),this.$playButton.removeClass("active").addClass("inactive"),this.state=a;break;case"paused":this.isPlaying=!1,this.$pauseButton.removeClass("active").addClass("inactive"),this.$playButton.removeClass("inactive").addClass("active"),this.state=a;break;case"volume":this.volume=b.volume,0==this.volume?(this.$unmuteButton.removeClass("inactive").addClass("active"),this.$muteButton.removeClass("active").addClass("inactive")):(this.$unmuteButton.removeClass("active").addClass("inactive"),this.$muteButton.removeClass("inactive").addClass("active")),this.$volumeMarker[0].style.width=parseInt(100*this.volume)+"%";break;case"load_progress":this.$loadProgress[0].style.width=parseInt(100*b.percent)+"%";break;case"play_progress":"buffering"==this.state&&this.$buffering.removeClass("active").addClass("inactive"),this.$playProgress[0].style.width=parseInt(100*b.percent)+"%";break;case"fullscreen":this.breakListeners(),this.bindListeners(),this.$element.addClass("fullscreen"),this.$fullscreenButton.removeClass("active").addClass("inactive"),this.$normalscreenButton.removeClass("inactive").addClass("active"),this.objConfig.onFullscreen&&this.objConfig.onFullscreen(),this.isPlaying&&this.play();break;case"normalscreen":this.breakListeners(),this.bindListeners(),this.$element.removeClass("fullscreen"),this.$fullscreenButton.removeClass("inactive").addClass("active"),this.$normalscreenButton.removeClass("active").addClass("inactive"),this.objConfig.onNormalscreen&&this.objConfig.onNormalscreen(),this.isPlaying&&this.play()}},SimpleVideo.prototype.showControls=function(){this.solution&&"nomedia"!=this.state&&(this.isOver=!0,this.controlsActive=!0,this.$controls.removeClass("inactive").addClass("active"),this.isVideo&&this.setHide(2500))},SimpleVideo.prototype.hideControls=function(){this.solution&&this.isVideo&&(this.isOver=!1,this.controlsActive=!1,this.$controls.removeClass("active").addClass("inactive"))},SimpleVideo.prototype.setHide=function(a){if(this.solution&&this.isVideo){clearTimeout(this.hideTimeout);var b=this;this.hideTimeout=setTimeout(function(){b.hideControls()},a)}},SimpleVideo.prototype.setFile=function(a,b){this.solution&&("undefined"==typeof b&&(b=!1),this.firstLoad=!0,this.controller.setFile(a),this.isVideo=!b,this.objConfig.nativeControls?b?this.controller.setPoster(this.audioPoster):this.controller.setPoster(this.audioPoster):(b?(this.$audioOnly.removeClass("inactive"),this.showControls()):(this.$audioOnly.addClass("inactive"),this.hideControls()),this.$loadProgress[0].style.width=this.$playProgress[0].style.width=0))},SimpleVideo.prototype.setHasAudio=function(a){a?this.$element.removeClass("no-audio"):this.$element.addClass("no-audio")},SimpleVideo.prototype.setScrub=function(a){this.canScrub=a},SimpleVideo.prototype.play=function(){this.solution&&this.controller.play()},SimpleVideo.prototype.pause=function(){this.solution&&this.controller.pause()},SimpleVideo.prototype.restart=function(){this.solution&&(this.setHide(2500),this.controller.seek(0))},SimpleVideo.prototype.clear=function(){this.solution&&this.controller.clear()},SimpleVideo.prototype.setRepeat=function(a){this.solution&&this.controller.setRepeat(a)},SimpleVideo.prototype.mute=function(){this.solution&&this.controller.setMute(!0)},SimpleVideo.prototype.unmute=function(){this.solution&&this.controller.setMute(!1)},SimpleVideo.prototype.maxVolume=function(){this.solution&&this.controller.setVolume(1)},SimpleVideo.prototype.vSliderClick=function(a){this.solution&&this.controller.setVolume((a.pageX-this.$volumeSlider.offset().left)/this.$volumeSlider.width())},SimpleVideo.prototype.scrubberClick=function(a){this.solution&&this.canScrub&&this.controller.seek((a.pageX-this.$scrubber.offset().left)/this.$scrubber.width())},SimpleVideo.prototype.fullscreen=function(){if(this.solution&&"nomedia"!=this.state){if(fullScreenApi.supportsFullScreen&&this.objConfig.trueFullscreen)fullScreenApi.requestFullScreen(this.$element[0]);else{this.$swapDiv=$("<div>Fullscreen</div>"),this.$element.replaceWith(this.$swapDiv),$("body").append(this.$element);var a=this;$(document).bind("keyup.sv",function(b){27==b.keyCode&&a.normalscreen()})}this.controller.setFullscreen(!0)}},SimpleVideo.prototype.normalscreen=function(){fullScreenApi.supportsFullScreen&&this.objConfig.trueFullscreen?fullScreenApi.cancelFullScreen():(this.$swapDiv.replaceWith(this.$element),this.$swapDiv=null,$(document).unbind("keyup.sv")),this.controller.setFullscreen(!1)},HTMLController.prototype.bindListeners=function(){var a={id:this.sv.$element[0].id};this.$video.bind("play",a,SimpleVideoEventHandler.htmlEvent),this.$video.bind("pause",a,SimpleVideoEventHandler.htmlEvent),this.$video.bind("ended",a,SimpleVideoEventHandler.htmlEvent),this.$video.bind("volumechange",a,SimpleVideoEventHandler.htmlEvent),this.$video.bind("progress",a,SimpleVideoEventHandler.htmlEvent),this.$video.bind("timeupdate",a,SimpleVideoEventHandler.htmlEvent),this.$video.bind("abort",a,SimpleVideoEventHandler.htmlEvent),this.$video.bind("error",a,SimpleVideoEventHandler.htmlEvent),this.$video.bind("loadstart",a,SimpleVideoEventHandler.htmlEvent),this.$video.bind("stalled",a,SimpleVideoEventHandler.htmlEvent),this.$video.bind("playing",a,SimpleVideoEventHandler.htmlEvent),this.$video.bind("waiting",a,SimpleVideoEventHandler.htmlEvent)},HTMLController.prototype.breakListeners=function(){this.$video.unbind()},HTMLController.prototype.init=function(a){a()},HTMLController.prototype.htmlEvent=function(a){switch("timeupdate"!=a.type,a.type){case"abort":this.sv.setState("nomedia");break;case"stalled":break;case"waiting":case"loadstart":this.sv.setState("buffering");break;case"playing":case"play":this.sv.setState("playing");break;case"pause":this.sv.setState("paused");break;case"volumechange":this.sv.setState("volume",{volume:this.$video[0].volume});break;case"ended":this.loop?this.play():(this.seek(0),this.pause());break;case"progress":var b=0;this.$video[0].buffered&&this.$video[0].buffered.length>0&&this.$video[0].buffered.end&&this.$video[0].duration?b=this.$video[0].buffered.end(0)/this.$video[0].duration:void 0!=this.$video[0].bytesTotal&&this.$video[0].bytesTotal>0&&void 0!=this.$video[0].bufferedBytes&&(b=this.$video[0].bufferedBytes/this.$video[0].bytesTotal),this.sv.setState("load_progress",{percent:b});break;case"timeupdate":this.sv.setState("play_progress",{percent:this.$video[0].currentTime/this.$video[0].duration})}},HTMLController.prototype.setFile=function(a){for(var b=0,c=a.length;c>b;b++)if(""!=this.$video[0].canPlayType(a[b].type)){this.$video[0].src=a[b].src;break}this.$video[0].controls=this.sv.objConfig.nativeControls},HTMLController.prototype.setPoster=function(a){this.$video.attr("poster",a)},HTMLController.prototype.clear=function(){this.$video[0].pause(),this.$video[0].src="",this.sv.setState("nomedia")},HTMLController.prototype.play=function(){this.$video[0].autoplay=!0,this.$video[0].play()},HTMLController.prototype.setRepeat=function(a){this.loop=a},HTMLController.prototype.pause=function(){this.$video[0].autoplay=!1,this.$video[0].pause()},HTMLController.prototype.seek=function(a){this.$video[0].currentTime=a*this.$video[0].duration},HTMLController.prototype.setMute=function(a){this.$video[0].volume=a?0:this.htmlVolume},HTMLController.prototype.setVolume=function(a){this.$video[0].volume=this.htmlVolume=a},HTMLController.prototype.setFullscreen=function(a){a?(this.$video[0].controls=!1,this.$video.addClass("fullscreen"),this.sv.setState("fullscreen")):(this.$video.removeClass("fullscreen"),this.sv.setState("normalscreen"))},FlashController.prototype.bindListeners=function(){},FlashController.prototype.breakListeners=function(){},FlashController.prototype.init=function(a){if(!this.valid)return a(),void 0;var b="/js/simplevideo/SimpleVideo.swf",c={playerId:this.sv.$element[0].id},d={allowScriptAccess:"always",menu:"false",wmode:"opaque"},e={id:this.flashId,name:this.flashId};this.initCallback=a,swfobject.embedSWF(b,this.flashId,"100%","100%","10","/swfobject/expressInstall.swf",c,d,e)},FlashController.prototype.flashEvent=function(a,b){switch(a){case"TRACE":break;case"LOADING_VIDEO":case"BUFFER_EMPTY":this.sv.setState("buffering");break;case"FLASH_LOADED":this.flashLoaded=!0,this.initCallback&&(this.initCallback(),this.initCallback=null);break;case"BUFFER_FULL":case"PLAYING":this.sv.setState("playing");break;case"PAUSED":this.sv.setState("paused");break;case"LOAD_PROGRESS":this.sv.setState("load_progress",b);break;case"PLAYHEAD_CHANGE":this.sv.setState("play_progress",b)}},FlashController.prototype.setFile=function(a){"undefined"==typeof this.$flash[0].callFunc&&(this.$flash=$(swfobject.getObjectById(this.flashId)));for(var b=0,c=a.length;c>b;b++)if(a[b].src.indexOf("mp4")>-1){this.$flash[0].callFunc("load",{url:a[b].src});break}},FlashController.prototype.setPoster=function(){},FlashController.prototype.clear=function(){this.$flash[0].callFunc("stopVideo"),this.sv.setState("nomedia")},FlashController.prototype.play=function(){this.$flash[0].callFunc("playVideo"),this.setVolume(this.sv.volume)},FlashController.prototype.setRepeat=function(a){this.$flash[0].callFunc("setRepeat",{repeat:a})},FlashController.prototype.pause=function(){this.$flash[0].callFunc("pause")},FlashController.prototype.seek=function(a){this.$flash[0].callFunc("seek",{percent:a})},FlashController.prototype.setMute=function(a){a?(this.$flash[0].callFunc("mute"),this.sv.setState("volume",{volume:0})):(this.$flash[0].callFunc("unmute"),this.sv.setState("volume",{volume:this.flashVolume}))},FlashController.prototype.setVolume=function(a){this.flashVolume=a,this.$flash[0].callFunc("setVolume",{volume:this.flashVolume}),this.sv.setState("volume",{volume:this.flashVolume})},FlashController.prototype.setFullscreen=function(a){a?(this.$flash.addClass("fullscreen"),this.sv.setState("fullscreen")):(this.$flash.removeClass("fullscreen"),this.sv.setState("normalscreen"))};var api=function(){var a={supportsFullScreen:!1,isFullScreen:function(){return!1},requestFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",prefix:""},b="webkit moz o ms khtml".split(" ");if("undefined"!=typeof document.cancelFullScreen)a.supportsFullScreen=!0;else for(var c=0,d=b.length;d>c;c++)if(a.prefix=b[c],"undefined"!=typeof document[a.prefix+"CancelFullScreen"]){a.supportsFullScreen=!0;break}a.supportsFullScreen&&(a.fullScreenEventName=a.prefix+"fullscreenchange",a.isFullScreen=function(){switch(this.prefix){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[this.prefix+"FullScreen"]}},a.requestFullScreen=function(a){return""===this.prefix?a.requestFullScreen():a[this.prefix+"RequestFullScreen"]()},a.cancelFullScreen=function(){return""===this.prefix?document.cancelFullScreen():document[this.prefix+"CancelFullScreen"]()}),"undefined"!=typeof jQuery&&(jQuery.fn.requestFullScreen=function(){return this.each(function(){a.supportsFullScreen&&a.requestFullScreen(this)})}),window.fullScreenApi=a}();